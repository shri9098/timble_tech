{#<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">#}
{#<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">#}
{#<head>#}
{#    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />#}
{#    <title>Registration</title>#}
{#    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>#}
{#    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">#}
{#    <!--Import materialize.css-->#}
{#    <link type="text/css" rel="stylesheet" href="/static/materialize/css/materialize.min.css" media="screen,projection"/>#}
{#    <!--Let browser know website is optimized for mobile-->#}
{#    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>#}
{#    <script type="text/javascript" src="/static/jquery.min.js"></script>#}
{#    <script type="text/javascript" src="/static/jquery-2.1.1.min.js"></script>#}
{#    <script type="text/javascript" src="/static/materialize/js/materialize.min.js"></script>#}
{#    <script src="/static/form_validation.js" type="text/javascript"></script>#}
{#      <script type="text/javascript" src="/static/register_dataParsing.js"></script>#}
{#</head>#}
{#{% csrf_token %}#}
{#<!--Start of Google Analytics-->#}
{#<script>#}
{#    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){#}
{#        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),#}
{#        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)#}
{#    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');#}
{#    ga('create', 'UA-101181025-1', 'auto');#}
{#    ga('send', 'pageview');#}
{##}
{#</script>#}
{#<!--End of Google Analitics-->#}
{#<script type="text/javascript">#}
{#        $(window).load(function () {#}
{#        $('#Preloader').delay(500).fadeOut();#}
{#    });#}
{#    $(document).ready(function()#}
{#    {#}
{#        $('.button-collapse').sideNav({#}
{#                menuWidth: 200, // Default is 300#}
{#                edge: 'right', // Choose the horizontal origin#}
{#                closeOnClick: true, // Closes side-nav on clicks, useful for Angular Meteor#}
{#                draggable: true // Choose whether you can drag to open on touch screens#}
{#            }#}
{#        );#}
{#        $('[tabindex]').focus(function()#}
{#        {#}
{#            $(this).css('outline', 'none');#}
{#        });#}
{#        $('.tooltipped').tooltip({delay: 50,html:true});#}
{##}
{#    });#}
{#</script>#}
{#<style type="text/css">#}
{#    .tooltipped{#}
{#        color: black;#}
{#    }#}
{#    .input-field label{#}
{#        color: black;#}
{#    }#}
{#</style>#}
{#<body>#}
{#<div id="modal1" class="modal">#}
{#    <div class="modal-content">#}
{#        <h5 id="modal1_text">Registration Successful</h5>#}
{#    </div>#}
{#    <div class="modal-footer center">#}
{#        <a class="btn modal-action modal-close">Ok</a>#}
{#    </div>#}
{#</div>#}
{#<div id="modal2" class="modal">#}
{#    <div class="modal-content">#}
{#        <h5 id="modal2_text"></h5>#}
{#    </div>#}
{#    <div class="modal-footer center">#}
{#        <a class="btn modal-action modal-close" style="margin: 2px">Cancel</a>#}
{#        <button class="btn modal-action modal-close" id="okRegisterData" style="margin: 2px">Ok</button>#}
{#    </div>#}
{#</div>#}
{##}
{#<div id="Preloader" style="display: flex;align-items: center;justify-content: center;background-color: white;position: fixed;z-index: 1000;#}
{#	top: 0;left: 0;right: 0;bottom: 0;">#}
{#    <div class="preloader-wrapper big active">#}
{#        <div class="spinner-layer spinner-blue-only">#}
{#            <div class="circle-clipper left">#}
{#                <div class="circle"></div>#}
{#            </div><div class="gap-patch">#}
{#            <div class="circle"></div>#}
{#        </div><div class="circle-clipper right">#}
{#            <div class="circle"></div>#}
{#        </div>#}
{#        </div>#}
{#    </div>#}
{#</div>#}
{##}
{#    <div class="row" style="margin-bottom: 0">#}
{#        <div class="col s12 m2"></div>#}
{#        <div class="col s12 m8">#}
{#            <div class="card white lighten-10 z-depth-3">#}
{#                <div class="card-content black-text">#}
{#                    {% csrf_token %}#}
{#                     <div class="row">#}
{#                        <div class="input-field col s0 m0 l2"></div><div class="input-field col s12 m12 l8">#}
{#                        <a class="tooltipped" data-position="top" data-delay="50">#}
{#                            <input id="location" name="location" type="text" class="validate" required>#}
{#                            <label for="mothers_name">Location</label></a>#}
{#                    </div><div id="mothers_name_error"style="color: #ff0000"></div>#}
{#                    </div>#}
{#                    <div class="row">#}
{#                        <div class="input-field col s0 m0 l2"></div><div class="input-field col s12 m12 l8">#}
{#                        <input name="first_name" id="first_name" type="text" class="validate" required>#}
{#                        <label for="first_name">First Name</label>#}
{#                    </div>#}
{#                        <div id="first_name_error" style="color:#ff0000"></div>#}
{#                    </div>#}
{#                    <div class="row">#}
{#                        <div class="input-field col s0 m0 l2"></div><div class="input-field col s12 m12 l8">#}
{#                        <a class="tooltipped" data-position="top" data-delay="50" data-tooltip="Don't include 'Mr.' or any prefix before name ">#}
{#                            <input id="fathers_name" name="fathers_name" type="text" class="validate" required>#}
{#                            <label for="fathers_name" >Father's Name</label></a>#}
{#                    </div><div id="fathers_name_error"style="color: #ff0000"></div>#}
{#                    </div>#}
{#                    <div class="row">#}
{#                        <div class="input-field col s0 m0 l2"></div><div class="input-field col s12 m12 l8">#}
{#                        <input id="email" type="email" name="email" class="validate" required>#}
{#                        <label for="email" >Email</label>#}
{#                    </div><div id="email_error"style="color: #ff0000"></div>#}
{#                    </div>#}
{#                    <div class="row">#}
{#                        <div class="input-field col s0 m0 l2"></div><div class="input-field col s12 m12 l8">#}
{#                        <input id="mobile" type="number" name="pnum" class="validate" required>#}
{#                        <label for="mobile" >Mobile:</label>#}
{#                    </div><div id="mobile_error"style="color: #ff0000"></div>#}
{#                    </div>#}
{#                      <div class="row">#}
{#                        <div class="input-field col s0 m0 l2"></div><div class="input-field col s12 m12 l8">#}
{#                        <input id="pin" type="number" name="pin_num" class="validate" required>#}
{#                        <label for="pin" >Pin Number:</label>#}
{#                    </div><div id="pin_error"style="color: #ff0000"></div>#}
{#                    </div>#}
{#                    <br/>#}
{#                    <div class="row">#}
{#                        <div class="input-field col s0 m0 l2"></div><div class="input-field col s12 m12 l8">#}
{#                        <input name="dob" id="dob" type="date" class="datepicker" required>#}
{#                        <label for="dob" class="active">DOB:</label>#}
{#                    </div><div id="dob_error"style="color: #ff0000"></div>#}
{#                    </div>#}
{#                    <div class="row">#}
{#                        <a class="tooltipped" data-position="right">#}
{#                            <div class="input-field col s0 m0 l2"></div>#}
{#                            <div class="input-field col s12 m12 l8">#}
{#                                <div class="file-field input-field" black>#}
{#                                    <div class="btn"  tabindex="1" id="pic_div" style="background-color:#102556">#}
{#                                        <span>Upload Image</span>#}
{#                                        <input type="file" name="pic" id="pic" accept="image/*" required>#}
{#                                    </div>#}
{#                                    <font color="black">#}
{#                                        <div blue class="file-path-wrapper">#}
{#                                            <input class="file-path validate" type="text" >#}
{#                                        </div>#}
{#                                    </font>#}
{#                                </div>#}
{#                            </div><div id="pic_error"style="color: #ff0000"></div>#}
{#                            <div class="input-field col s0 m0 l2">#}
{#                                <img id="displayImg" name="displayImg" height="100%" width="100%"/>#}
{#                            </div></a>#}
{#                    </div>#}
{#                         <div class="row">#}
{#                        <a class="tooltipped" data-position="right">#}
{#                            <div class="input-field col s0 m0 l2"></div>#}
{#                            <div class="input-field col s12 m12 l8">#}
{#                                <div class="file-field input-field" black>#}
{#                                    <div class="btn"  tabindex="1" id="pic_div" style="background-color:#102556">#}
{#                                        <span>Upload Pslip</span>#}
{#                                        <input type="file" name="slip" id="slip" accept=".xlsx,.xls,.doc, .docx,.csv, .pptx,.txt,.pdf">#}
{#                                    </div>#}
{#                                    <font color="black">#}
{#                                        <div blue class="file-path-wrapper">#}
{#                                            <input class="file-path validate" type="text" >#}
{#                                        </div>#}
{#                                    </font>#}
{#                                </div>#}
{#                            </div>#}
{#                            <div id="slip_error"style="color: #ff0000"></div>#}
{#                            <div class="input-field col s0 m0 l2">#}
{#                                <img id="displayImg" name="displayImg" height="100%" width="100%"/>#}
{#                            </div></a>#}
{#                    </div>#}
{#                    <div class="row center">#}
{#                        <button class="btn accent-1" id="btnSubmit" type="submit" name="action" style="background-color:#102556">#}
{#                            Submit#}
{#                            <i class="material-icons right">send</i>#}
{#                        </button>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}
{#    <hr style="width: 100%;background-color:#102556;height: 15px ;margin: 0;border: 0">#}
{#</body>#}
{#</html>#}

<!DOCTYPE html>
<html>
<body>
        <h5 id="errorid">this field in not empty</h5>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
{#<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>#}

<h2>HTML Forms</h2>

<form name="myForm" id="register_data" method="post">{% csrf_token %}
<br>
  <input type="text" name="location"  id = "location" placeholder="Location" class="frm" required><br>
  <br>
  <input type="text" name="first_name" id = "first_name" placeholder="Name" class="frm" required><br>
    <br>
  <input type="text" name="father_name"  id = "fathers_name" placeholder="Father Name" class="frm" required><br>
  <br>
  <input type="number" name="mobile" id = "mobile" placeholder="Mobile No." class="frm" maxlength="10" required><br>
     <br>
  <input type="email" name="email"  id = "email" placeholder="email Id"  class="frm"><br>
  <br>
  <input type="number" name="pin_number" id = "pin_number" placeholder="Pin No." class="frm" maxlength="6" required><br>
    <br>
  <input type="file" name="pic" id="pic" accept="image/*" height="100%" width="100%"  class="frm" required><br>
    <br>
  <input type="file" name="pay_slip"  id = "pay_slip" placeholder="upload Salary slip"
          accept=".xlsx,.xls,.doc, .docx,.ppt, .pptx,.txt,.pdf"  class="frm" required><br>
    <br>Date of birth<br>
  <input type="date" name="dob" id = "dob" placeholder="DOB"  class="frm" required><br>
    <br>
    <button type="submit" value="Submit" id="btnvalidate" onclick="getRegisterData()">submit</button>
</form>

</body>
</html>
<script>
      function getRegisterData() {
        console.log("say hii");
        var location = document.getElementById("location").value;
        var first_name = document.getElementById("first_name").value;
        var father_name = document.getElementById("fathers_name").value;
        var number = document.getElementById("mobile").value;
        var email = (document.getElementById("email").value).toLowerCase();
        var pin_number = document.getElementById("pin_number").value;

        var dob = document.getElementById("dob").value;


        var pay_slip = $('#pay_slip')[0].value;
        var file = pay_slip.split('\\').pop();
        file = file.split('').join('_');
        var pic = $('#pic')[0].value;
        var image = pic.split('\\').pop();
        image = image.split(' ').join('_');
        var register_data = {};

        console.log(register_data);
        register_data['location'] = location;
        register_data["first_name"] = first_name;
        register_data["father_name"] = father_name;
        register_data["email"] = email;
        register_data["number"] = number;
        register_data["pin_number"] = pin_number;
        register_data["dob"] = dob;


        // Get the html uploaded file
        var data = new FormData();
        var img = $('#pic')[0].files[0];
        var fl = $('#pay_slip')[0].files[0];
        console.log(fl);
        data.append('img', img);
        data.append('fl', fl);
        data.append('user-data', JSON.stringify(register_data));
        // alert(JSON.stringify(register_data));
        data.append('img_path', image.toString());

        data.append('user-data', JSON.stringify(register_data));
        data.append('fl_path', file.toString());
        $.ajax({
            url: "/registration/",
            method: "POST",
            data: data,
            processData: false,
            contentType: false,
            success: function (json_data) {
                if (json_data.response === 'success') {
                    alert('Registration Successful');

                    setTimeout(function () {
                        location.reload();
                    }, 3000);
                }

            }

        });


}


</script>